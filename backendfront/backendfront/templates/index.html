<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Carrossel de Músicas</title>

<style>
  html, body { height: 100%; margin: 0; }
  body {
    background: linear-gradient(180deg, rgba(102,102,102,1) 0%, rgba(0,0,0,1) 100%);
    color: white; font-family: Arial, Helvetica, sans-serif;
  }

  .container {
    max-width: 1100px;
    margin: 28px auto;
    padding: 0 18px 48px;
    box-sizing: border-box;
  }

  /* BOTÃO ADICIONAR MÚSICA */
  .add-form {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
  }
  .add-form input {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.2);
    flex: 1;
    background: rgba(255,255,255,0.1);
    color: white;
  }
  .add-form button {
    padding: 10px 16px;
    border-radius: 8px;
    border: none;
    background: rgba(255,255,255,0.25);
    color: white;
    cursor: pointer;
  }

  /* Busca */
  .search-wrap {
    display: flex;
    align-items: center;
    margin-bottom: 22px;
  }
  .search {
    flex: 1;
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.06);
    padding: 12px 16px;
    border-radius: 28px;
    border: 1px solid rgba(255,255,255,0.06);
  }
  .search input {
    flex: 1;
    background: transparent;
    border: none;
    color: white;
    outline: none;
  }

  /* Carrossel */
.carousel-wrap {
  width: 100vw;                          /* largura da viewport */
  margin-left: calc(50% - 50vw);         /* centraliza full-bleed dentro do container */
  margin-right: calc(50% - 50vw);
  box-sizing: border-box;
  padding-left: 18px;                    /* mantém o padding interno que você costuma usar */
  padding-right: 18px;
}
  .carousel {
    height: 100%;
    width: 100%;
    display:flex;
    overflow-x:auto;
    gap: 20px;
    padding: 16px 0;
    scroll-behavior: smooth;
  }
  .carousel-item {
    min-width: 520px;
    height: 100%;
    flex: 0 0 auto;
  }
  .carousel-container {
    overflow-x: auto;
    scroll-behavior: smooth;
    cursor: grab;
}

.carousel-container {
    display: flex;
    gap: 20px;
    overflow-x: auto;
    scroll-behavior: smooth;
    cursor: grab;
    padding: 10px;
    width: 100%;        /* ocupa toda a faixa horizontal */
    height: 100%;
}

.carousel-container:active {
    cursor: grabbing;
}

.carousel-container::-webkit-scrollbar {
    display: none;
}

.item {
    aspect-ratio: 2 / 1;
    flex: 0 0 350px;   /* define “tamanho base” do card (350px largura) */
    max-height: 200px; /* altura máxima */
}


  .card {
    width: 100%;
    height: 92%;
    border-radius: 12px;
    background: rgba(255,255,255,0.08);
    display: grid;
    grid-template-rows: 1fr auto;
    overflow: hidden;
  }
  .card-body {
    display: flex;
    gap: 16px;
    padding: 16px;
  }
  .thumb {
    width: 220px;
    height: 140px;
    border-radius: 10px;
    overflow: hidden;
  }
  .thumb img {
    width:100%; height:100%; object-fit: cover;
  }
  .meta { flex: 1; }
  .forms { margin-top: 12px; display:flex; gap: 10px; }
  .forms input {
    flex: 1;
    padding: 6px 10px;
    border-radius: 6px;
    border: none;
    background: rgba(255,255,255,0.1);
    color: white;
  }
  .forms button {
    padding: 6px 10px;
    border-radius: 6px;
    border: none;
    background: rgba(255,255,255,0.25);
    cursor:pointer;
    color:white;
  }

  .meta-bottom {
    padding: 12px;
    background: rgba(0,0,0,0.2);
  }
</style>
</head>
<body>

<div class="container">

  <!-- FORM ADICIONAR -->
  <form class="add-form" action="/create" method="post">
    <input type="text" name="nomemusica" placeholder="Adicionar nova música..." required>
    <button type="submit">Adicionar</button>
  </form>

  <!-- Busca -->
  <form class="search-wrap" method="get" action="/">
    <div class="search">
      <input type="search" name="q" placeholder="Buscar..." value="{{ request.args.get('q') }}">
      <button type="submit" style="display:none;"></button>
    </div>
  </form>

  <!-- Carrossel -->
  <div class="carousel-wrap">
    <div class="carousel-container">
    {% if musicas|length == 0 %}
        <h3 style="margin:auto;color:#ddd;">Nenhuma música encontrada.</h3>
    {% endif %}

    {% for musica in musicas %}
      <div class="carousel-item">
        <div class="card">
          <div class="card-body">

            <div class="thumb">
              <img src="https://picsum.photos/seed/{{ musica.id }}/600/400">
            </div>

            <div class="meta">
              <h2>{{ musica.nomemusica }}</h2>
              <p>ID: {{ musica.id }}</p>

              <div class="forms">
                <!-- UPDATE -->
                <form action="/update/{{ musica.id }}" method="post">
                  <input type="text" name="nomemusica" value="{{ musica.nomemusica }}">
                  <button type="submit">Atualizar</button>
                </form>

                <!-- DELETE -->
                <form action="/delete/{{ musica.id }}" method="post">
                  <button type="submit" onclick="return confirm('Deletar esta música?')">Deletar</button>
                </form>
              </div>

            </div>
          </div>

          <div class="meta-bottom">
            #{{ musica.id }}
          </div>
        </div>
      </div>
    {% endfor %}
    </div>
  </div>

</div>
<script>
const slider = document.querySelector('.carousel-container');
let isDown = false;
let startX;
let scrollLeft;

slider.addEventListener('mousedown', (e) => {
    isDown = true;
    slider.classList.add('active');
    startX = e.pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
});
slider.addEventListener('mouseleave', () => {
    isDown = false;
});
slider.addEventListener('mouseup', () => {
    isDown = false;
});
slider.addEventListener('mousemove', (e) => {
    if (!isDown) return;
    e.preventDefault();
    const x = e.pageX - slider.offsetLeft;
    const walk = (x - startX) * 2; // velocidade
    slider.scrollLeft = scrollLeft - walk;
});


slider.addEventListener('mousedown', (e) => {
    isDown = true;
    startX = e.pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
});
slider.addEventListener('mouseleave', () => isDown = false);
slider.addEventListener('mouseup', () => isDown = false);
slider.addEventListener('mousemove', (e) => {
    if (!isDown) return;
    e.preventDefault();
    const x = e.pageX - slider.offsetLeft;
    slider.scrollLeft = scrollLeft - (x - startX) * 2;
});
</script>
</body>
</html>
